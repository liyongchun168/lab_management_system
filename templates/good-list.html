{% extends 'base.html' %}
{% load bootstrap3 %}
{% block title %}
物品管理
{% endblock %}
{% block style %}
    <style>
        .table th, .table td {
        text-align: center;
        vertical-align: middle!important;
}
    </style>
{% endblock %}

{% block content %}
    <div class="container">
    {#    <form class="form-inline" role="form" method="POST">#}
    {#        {% csrf_token %}#}
    {#        {% bootstrap_form good_form %}#}
    {#      <button type="submit" class="btn btn-default">添加</button>#}
    {#    </form>#}


        <table class="table table-striped table-hover">
        {#    <caption>物品列表</caption>#}
            <thead>
                <tr>
                    <th>编号</th>
                    <th>物品</th>
                    <th>价格</th>
                    <th>数量</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                {% for good in goods %}
                    <tr>
                        <td><a href="{% url 'good_detail' good.id %}">{{ good.id }}</a></td>
                        <td>{{ good.name }}</td>
                        <td>{{ good.price }}</td>
                        <td>{{ good.active_num }}/{{ good.all_num }}</td>

                        <td>
                            {% if user.is_superuser %}
                                <span id="{{ good.id }}" class="del glyphicon glyphicon-trash"></span>
                                <a href="{% url 'edit_good' good.id %}"><span class="glyphicon glyphicon-edit"></span></a>
                            {% else %}
                                <a href="{% url 'good-reply' good.id %}">申请</a>
                        {% endif %}

                        </td>

                    </tr>
                {% endfor %}
            </tbody>
        </table>
        {% if goods.has_next %}
        <nav aria-label="Page navigation">
          <ul class="pagination">
              {% if goods.has_previous %}
                  <li>
                      <a href="?page={{ goods.previous_page_number }}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                      </a>
                  </li>
              {% endif %}

            {%  for pg in goods.paginator.page_range %}
                {% if goods.number == pg %}
                    <li class="active"><a href="?page={{ pg }}">{{ pg }}</a></li>
                {% else %}
                    <li><a href="?page={{ pg }}">{{ pg }}</a></li>
                {% endif %}
            {% endfor %}

            {% if goods.has_next %}
                <li>
                  <a href="?page={{ goods.next_page_number }}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
                {% endif %}
          </ul>
        </nav>
    {% endif %}
    </div>
    {% block script %}
        <script>
        $(document).ready(function () {
            $(".del").click(function () {
                if(!confirm("确认删除吗？")){
                    return false;
                }
                var self = this;
                var goodid = $(this).attr("id");
                $.post("{% url 'del_good' %}",{'id':goodid},function () {
                    $(self).parent().parent().remove()
                });
            });
        });
        </script>
    {% endblock %}
{% endblock %}